{% load object_log_tags %}

<table class="object_log">
    {% for item in log %}
        <tr>
            <td class="timestamp">{{ item.timestamp|date:"m/d/Y" }}</td>
            <td>{{ item.timestamp|date:"H:i" }}</td>
            <td>{{ item|render_context:context }}</td>
        </tr>
    {% empty %}
        <tr class="none"><td class="none">- empty -</td></tr>
    {% endfor %}
</table>


<script type="text/javascript">
    function format_log_timestamps() {
        var current;
        $('table.object_log .timestamp').each(function(){
            var td = $(this);
            var timestamp = new Date(td.html());
            if (current == undefined
                || timestamp.getDay() > current.getDay()
                || timestamp.getMonth() > current.getMonth()
                || timestamp.getYear() > current.getYear())
            {
                current = timestamp;
            } else {
                td.html("");
            }
        });
    }
    format_log_timestamps();
</script>
